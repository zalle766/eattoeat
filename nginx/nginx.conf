server {
    listen 80;
    server_name 195.200.15.167;  # استبدله بعنوان IP الخاص بخادمك

    # مسار ملفات React
    root /var/www/react/build;    # استبدله بمسار مجلد الـ build لمشروع React
    index index.html;

    # عرض صفحات React
    location / {
        try_files $uri /index.html;
    }

    # مسار Laravel (للـ API)
    location /api/ {
        alias /var/www/laravel/public;  # استبدله بمسار مشروع Laravel
        try_files $uri /index.php?$query_string;
    }

    # معالجة ملفات PHP الخاصّة بـ Laravel
    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;  # تأكد أن إصدار PHP هو 8.1
        fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
    }

    # حماية ملفات الحساسة (مثل .env)
    location ~ /\.(ht|env)$ {
        deny all;
    }

    # تحسينات لتخزين الكاش للملفات الثابتة
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}