# Script to fix invalid UUIDs in supabase_seed_data.sql
# This script replaces all invalid UUIDs (catX-..., itemX-...) with valid UUIDs

$filePath = "database\supabase_seed_data.sql"
$content = Get-Content $filePath -Raw -Encoding UTF8

# Generate valid UUIDs for categories and items
# We'll use a pattern that's valid but still readable

# Replace category UUIDs
$catPatterns = @(
    @{old='cat1-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440001'},
    @{old='cat1-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440002'},
    @{old='cat1-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440003'},
    @{old='cat1-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440004'},
    @{old='cat2-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440011'},
    @{old='cat2-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440012'},
    @{old='cat2-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440013'},
    @{old='cat2-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440014'},
    @{old='cat3-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440021'},
    @{old='cat3-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440022'},
    @{old='cat3-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440023'},
    @{old='cat3-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440024'},
    @{old='cat4-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440031'},
    @{old='cat4-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440032'},
    @{old='cat4-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440033'},
    @{old='cat4-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440034'},
    @{old='cat5-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440041'},
    @{old='cat5-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440042'},
    @{old='cat5-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440043'},
    @{old='cat5-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440044'},
    @{old='cat6-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440051'},
    @{old='cat6-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440052'},
    @{old='cat6-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440053'},
    @{old='cat6-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440054'},
    @{old='cat7-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440061'},
    @{old='cat7-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440062'},
    @{old='cat7-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440063'},
    @{old='cat7-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440064'},
    @{old='cat8-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440071'},
    @{old='cat8-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440072'},
    @{old='cat8-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440073'},
    @{old='cat8-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440074'},
    @{old='cat9-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440081'},
    @{old='cat9-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440082'},
    @{old='cat9-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440083'},
    @{old='cat9-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440084'},
    @{old='cat10-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440091'},
    @{old='cat10-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440092'},
    @{old='cat10-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440093'},
    @{old='cat10-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440094'},
    @{old='cat11-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440101'},
    @{old='cat11-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440102'},
    @{old='cat11-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440103'},
    @{old='cat11-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440104'},
    @{old='cat12-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440111'},
    @{old='cat12-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440112'},
    @{old='cat12-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440113'},
    @{old='cat12-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440114'},
    @{old='cat13-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440121'},
    @{old='cat13-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440122'},
    @{old='cat13-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440123'},
    @{old='cat13-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440124'},
    @{old='cat14-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440131'},
    @{old='cat14-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440132'},
    @{old='cat14-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440133'},
    @{old='cat14-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440134'},
    @{old='cat15-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440141'},
    @{old='cat15-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440142'},
    @{old='cat15-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440143'},
    @{old='cat15-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440144'},
    @{old='cat16-1111-1111-1111-111111111111'; new='550e8400-e29b-41d4-a716-446655440151'},
    @{old='cat16-2222-2222-2222-222222222222'; new='550e8400-e29b-41d4-a716-446655440152'},
    @{old='cat16-3333-3333-3333-333333333333'; new='550e8400-e29b-41d4-a716-446655440153'},
    @{old='cat16-4444-4444-4444-444444444444'; new='550e8400-e29b-41d4-a716-446655440154'}
)

foreach ($pattern in $catPatterns) {
    $content = $content -replace [regex]::Escape($pattern.old), $pattern.new
}

# Replace item UUIDs - we'll use a different pattern
$itemCounter = 200
$itemPatterns = @()
for ($i = 1; $i -le 16; $i++) {
    for ($j = 1; $j -le 9; $j++) {
        $oldPattern = "item$i-$($j.ToString().PadLeft(4,'1'))-1111-1111-111111111111"
        $newUUID = "550e8400-e29b-41d4-a716-44665544" + ($itemCounter.ToString().PadLeft(4,'0'))
        $itemPatterns += @{old=$oldPattern; new=$newUUID}
        $itemCounter++
    }
}

# Actually, let's use a simpler approach - replace all item UUIDs with a regex
$content = $content -replace "'item(\d+)-(\d+)-1111-1111-111111111111'", {
    param($match)
    $itemNum = [int]$match.Groups[1].Value
    $itemSub = [int]$match.Groups[2].Value
    $newUUID = "550e8400-e29b-41d4-a716-44665544" + (200 + ($itemNum - 1) * 10 + $itemSub).ToString().PadLeft(4,'0')
    "'$newUUID'"
}

# Save the file
Set-Content -Path $filePath -Value $content -Encoding UTF8
Write-Host "Fixed all UUIDs in $filePath" -ForegroundColor Green

